/*!
 * frontkit v0.0.1
 * The powerful front-end framework from InJoin.
 *
 * https://github.com/injoin/frontkit
 */
!function(a){"use strict";a.module("frontkit",["frontkit.checkbox","frontkit.dropdown"])}(angular),!function(a){"use strict";var b="<span class='DIRECTIVE' tabindex='0'></span>",c=a.module("frontkit.checkbox",["frontkit.utils"]);["checkbox","radio"].forEach(function(a){var d=b.replace("DIRECTIVE",a);c.directive(a,["$compile","$timeout","keycodes",function(a,b,c){var e={};return e.restrict="A",e.link=function(e,f){var g=a(d)(e);f.after(g),f.addClass("hide"),f.on("$destroy",function(){g.remove()}),g.on("keypress",function(a){("keypress"!==a.type||a.which===c.SPACE)&&(g.triggerHandler("click"),a.preventDefault())}),g.on("click",function(a){a.preventDefault(),f.prop("checked",!f.prop("checked")),b(function(){f.triggerHandler("click")})})},e}])})}(angular),!function(a){"use strict";var b=a.element,c=a.module("frontkit.dropdown",["frontkit.utils"]);c.value("dropdownConfig",{optionsPageSize:5}),c.directive("dropdown",["$document",function(c){var d={};return d.restrict="EA",d.replace=!0,d.transclude=!0,d.templateUrl="templates/dropdown/single.html",d.controller="DropdownController",d.controllerAs="$dropdown",d.scope=!0,d.require=["dropdown","?ngModel"],d.compile=function(a,b){var c=b.ngModel;return c&&b.$set("ngModel","$parent."+c),d.link},d.link=function(d,e,f,g,h){var i=g[0],j=g[1];j&&(d.$watch("$dropdown.items",function(a){a=1===i.maxItems?a[0]:a,j.$setViewValue(a)},!0),j.$render=function(){var b=j.$viewValue;return null==b?void(i.items=[]):void(i.items=a.isArray(b)?b:[b])}),h(d,function(a){var c=b("<div>").append(a),d=c.querySelector(".dropdown-items"),f=c.querySelector(".dropdown-options");d.length&&e.querySelector(".dropdown-container").prepend(d),f.length&&e.querySelector("dropdown-options").replaceWith(f)}),e.on("click",function(a){a.stopPropagation()}),c.on("click",function(){d.$safeApply(i.close)})},d}]),c.controller("DropdownController",["$scope","$attrs","$q",function(b,c,d){function e(){f.search=g}var f=this,g="";f.options=[],f.items=[],f.placeholder=null,f.valueKey=null,f.open=!1,f.search=g,f.maxItems=+c.maxItems||1,f.activeOption=null,f.isFull=function(){return f.items.length>=f.maxItems},f.addItem=function(a){1===f.maxItems?f.items=[a]:f.isFull()||f.items.push(a),f.isFull()&&f.close()},f.close=function(){f.open=!1,e()},f.parseOptions=function(c){var e;b.$watch(c,function(b){var c;e=null,null==b?f.options=[]:(c=d.when(b).then(function(b){var d,g=a.isArray(b);if(c===e){if(!g&&!a.isObject(b))throw new Error("Dropdown options should be array or object!");f.options=b,d=g?0:Object.keys(b)[0],f.activeOption=b[d]}}),e=c)},!0)}}]),c.directive("dropdownItems",["$compile",function(a){var b={};return b.restrict="EA",b.replace=!0,b.transclude=!0,b.templateUrl="templates/dropdown/items.html",b.require="^dropdown",b.link=function(b,c,d,e,f){var g=c.querySelector(".dropdown-item");f(function(a){g.append(a)}),g.attr("ng-repeat","item in $dropdown.items"),a(g)(b),d.$observe("placeholder",function(a){e.placeholder=a})},b}]),c.directive("dropdownOptions",["$compile","repeatParser","dropdownConfig",function(c,d,e){var f={};return f.restrict="EA",f.replace=!0,f.transclude=!0,f.templateUrl="templates/dropdown/options.html",f.require="^dropdown",f.compile=function(a){return a.parent().length?f.link:void 0},f.link=function(f,g,h,i,j){function k(){var b,c,d,e=i.options,f=m.scrollTop;a.isArray(e)?c=e.indexOf(i.activeOption):(c=-1,Object.keys(e).some(function(a,b){return e[a]===i.activeOption?(c=b,!0):void 0})),d=m.querySelectorAll(".dropdown-option")[c],i.open&&d&&(b=d.offsetTop-m.scrollTop,0>b?f=d.offsetTop:m.clientHeight<=b+d.clientHeight&&(f=d.offsetTop+d.clientHeight-m.clientHeight),m.scrollTop=f)}function l(){var a,c=m.ownerDocument.defaultView,d=c.getComputedStyle(m,null),f=g.css("display"),h=e.optionsPageSize,i=b("<li class='dropdown-option'>&nbsp;</li>")[0];g.prepend(i),g.css("display","block"),a=i.clientHeight*h,a=["padding","border"].reduce(function(a,b){var c=d.getPropertyValue(b+"-top")||"",e=d.getPropertyValue(b+"-bottom")||"";return a+=+c.replace("px","")||0,a+=+e.replace("px","")||0},a),g.css({"overflow-y":"auto","max-height":a+"px"}),g.css("display",f),b(i).remove()}var m=g[0],n=g.querySelector(".dropdown-option"),o=d.parse(h.items);o&&(i.parseOptions(o.expr),o.expr="$dropdown.options",j(function(a){n.append(a)}),n.attr("ng-repeat",d.toNgRepeat(o)),n.attr("ng-click","$dropdown.addItem( "+o.item+" )"),n.attr("ng-class","{active: $dropdown.activeOption === "+o.item+"}"),c(n)(f)),l(),i.valueKey=h.value||null,f.$watch("$dropdown.open",k),f.$watch("$dropdown.activeOption",k)},f}]),c.directive("dropdownContainer",["keycodes",function(b){function c(a,b,c){c.search||(a.ctrlKey?c.items.splice(0):c.items.pop(),b.$safeApply())}function d(a,c,d){var e,f,g,h,i=d.options,j=d.activeOption;if(!d.open)return d.open=!0,void c.$safeApply();switch(h=i.indexOf(j),0>h&&(h=0,j=i[0]),a.preventDefault(),a.keyCode){case b.ARROWUP:f=-1;break;case b.ARROWDOWN:f=1;break;case b.PGUP:f=-4;break;case b.PGDOWN:f=4}e=0>f?0:i.length-1,g=0>f?"max":"min",j=i[Math[g](e,h+f)],j!==d.activeOption&&(d.activeOption=j,c.$safeApply())}function e(a,b,c){a.preventDefault(),c.open?c.addItem(c.activeOption):c.open=!0,b.$safeApply()}function f(a,c,d){a.keyCode!==b.TAB&&a.target.blur(),c.$safeApply(d.close)}var g,h;return h={},h[b.BACKSPACE]=c,h[b.TAB]=f,h[b.ESCAPE]=f,h[b.ARROWUP]=d,h[b.ARROWDOWN]=d,h[b.PGUP]=d,h[b.PGDOWN]=d,h[b.ENTER]=e,g={},g.restrict="C",g.require="^dropdown",g.link=function(b,c,d,e){var f=c.querySelector(".dropdown-input input");b.$watch("$dropdown.search",function(a){a&&!e.isFull()&&(e.open=!0)}),c.on("click",function(){f[0].focus()}),f.on("focus",function(){var a=e.isFull();(!a||a&&1===e.maxItems)&&(e.open=!0),b.$safeApply()}),f.on("keydown",function(c){var d,f=c.keyCode,g=h[f];return a.isFunction(g)?g(c,b,e):(d=String.fromCharCode(f).trim(),void(e.isFull()&&d&&c.preventDefault()))})},g}]),c.service("repeatParser",function(){var a=this,b=/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/,c=/^(?:([\$\w]+)|\(([\$\w]+)\s*,\s*([\$\w]+)\))$/;a.parse=function(a){var d,e,f,g,h,i=(a||"").match(b);return i&&(d=i[1],e=i[2],f=i[3],i=d.match(c))?(h=i[3]||i[1],g=i[2],{key:g,item:h,expr:e,trackBy:f}):void 0},a.toNgRepeat=function(a){var b=a.key?"("+a.key+", "+a.item+")":a.item,c=a.trackBy?" track by "+a.trackBy:"";return b+" in "+a.expr+c}})}(angular),!function(a){"use strict";var b=a.element,c=a.module("frontkit.utils",[]);c.constant("keycodes",{BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PGUP:33,PGDOWN:34,ARROWLEFT:37,ARROWUP:38,ARROWRIGHT:39,ARROWDOWN:40}),c.config(["$provide",function(b){var c=function(b){return"string"==typeof b||a.isFunction(b)};b.decorator("$rootScope",function(a){return a.$safeApply=function(b,d){var e;for(c(b)&&(d=b,b=a),b=b||a,c(d)&&b.$eval(d),e=b;e;){if(e.$$phase)return;e=e.$parent}b.$apply()},a})}]),b.prototype.querySelector=function(a){return b(this[0].querySelector(a))},b.prototype.querySelectorAll=function(a){return b(this[0].querySelectorAll(a))}}(angular),angular.module("frontkit").run(["$templateCache",function(a){"use strict";a.put("templates/dropdown/items.html",'<div class="dropdown-items">\n    <div class="dropdown-item"></div>\n</div>')}]),angular.module("frontkit").run(["$templateCache",function(a){"use strict";a.put("templates/dropdown/options.html",'<ul class="dropdown-options">\n    <li class="dropdown-option"></li>\n</ul>')}]),angular.module("frontkit").run(["$templateCache",function(a){"use strict";a.put("templates/dropdown/single.html",'<div class="dropdown" ng-class="{ open: $dropdown.open }">\n    <div class="dropdown-container">\n        <div class="dropdown-input">\n            <input type="text" ng-model="$dropdown.search"\n                   placeholder="{{ $dropdown.items.length ? null : $dropdown.placeholder }}">\n        </div>\n\n        <span class="dropdown-caret"></span>\n    </div>\n\n    <dropdown-options></dropdown-options>\n</div>')}]);