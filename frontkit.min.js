/*!
 * frontkit v0.1.2
 * The powerful front-end framework from InJoin.
 *
 * https://github.com/injoin/frontkit
 */
!function(a){"use strict";a.module("frontkit",["frontkit.checkbox","frontkit.dropdown"])}(angular),!function(a){"use strict";var b="<span class='DIRECTIVE' tabindex='0'></span>",c=a.module("frontkit.checkbox",["frontkit.utils"]);["checkbox","radio"].forEach(function(a){var d=b.replace("DIRECTIVE",a);c.directive(a,["$compile","$timeout","keycodes",function(a,b,c){var e={};return e.restrict="A",e.link=function(e,f){var g=a(d)(e);f.after(g),f.addClass("hide"),f.on("$destroy",function(){g.remove()}),g.on("keypress",function(a){("keypress"!==a.type||a.which===c.SPACE)&&(g.triggerHandler("click"),a.preventDefault())}),g.on("click",function(a){a.preventDefault(),f.prop("checked",!f.prop("checked")),b(function(){f.triggerHandler("click")})})},e}])})}(angular),!function(a){"use strict";var b=a.element,c=a.module("frontkit.dropdown",["frontkit.utils"]);c.value("dropdownConfig",{optionsPageSize:5}),c.directive("dropdown",["$document",function(c){var d={};return d.restrict="EA",d.replace=!0,d.transclude=!0,d.templateUrl="templates/dropdown/single.html",d.controller="DropdownController",d.controllerAs="$dropdown",d.scope=!0,d.require=["dropdown","?ngModel"],d.compile=function(a,b){var c=b.ngModel;return c&&b.$set("ngModel","$parent."+c),d.link},d.link=function(d,e,f,g,h){var i=g[0],j=g[1];j&&(d.$watch("$dropdown.items",function(a){a=1===i.maxItems?a[0]:a,j.$setViewValue(a)},!0),j.$render=function(){var b=j.$viewValue;return null==b?void(i.items=[]):void(i.items=a.isArray(b)?b:[b])}),h(d,function(a){var c=b("<div>").append(a),d=c.querySelector(".dropdown-item"),f=c.querySelector(".dropdown-options");d.length&&e.querySelector(".dropdown-container").prepend(d),f.length&&e.querySelector("dropdown-options").replaceWith(f)}),e.on("click",function(a){a.stopPropagation()}),c.on("click",function(){d.$safeApply(i.close)})},d}]),c.controller("DropdownController",["$scope","$attrs","$q",function(b,c,d){function e(){f.search=g}var f=this,g="";f.options=[],f.items=[],f.placeholder=null,f.valueKey=null,f.open=!1,f.search=g,f.activeOption=null,b.$parent.$watch(c.maxItems,function(a){f.maxItems=+a||1}),f.isFull=function(){return f.items.length>=f.maxItems},f.addItem=function(a){var b=!0;1===f.maxItems?f.items=[a]:f.isFull()||f.isSelected(a)?b=!1:f.items.push(a),b&&(f.activeOption=f.findAvailableOption(a)),f.isFull()&&f.close()},f.close=function(){f.open=!1,e()},f.isSelected=function(a){return!!~f.items.indexOf(a)},f.findAvailableOption=function(a){var b=f.options,c=b.indexOf(a),d=c===b.length-1?-1:1;if(1===f.maxItems)return a;do c+=d,a=b[c];while(f.isSelected(a));return a},f.parseOptions=function(c){var e;b.$watch(c,function(b){var c;e=null,null==b?f.options=[]:(c=d.when(b).then(function(b){var d,g=a.isArray(b);if(c===e){if(!g&&!a.isObject(b))throw new Error("Dropdown options should be array or object!");f.options=b,d=g?0:Object.keys(b)[0],f.activeOption=b[d]}}),e=c)},!0)}}]),c.directive("dropdownItems",["$compile",function(a){var b={};return b.restrict="EA",b.replace=!0,b.transclude=!0,b.templateUrl="templates/dropdown/items.html",b.require="^dropdown",b.link=function(b,c,d,e,f){f(function(a){c.append(a)}),c.attr("ng-repeat","item in $dropdown.items"),a(c)(b),d.$observe("placeholder",function(a){e.placeholder=a})},b}]),c.directive("dropdownOptions",["$compile","repeatParser","dropdownConfig",function(c,d,e){var f={};return f.restrict="EA",f.replace=!0,f.transclude=!0,f.templateUrl="templates/dropdown/options.html",f.require="^dropdown",f.compile=function(a){return a.parent().length?f.link:void 0},f.link=function(f,g,h,i,j){function k(){var b,c,d,e=i.options,f=m.scrollTop;a.isArray(e)?c=e.indexOf(i.activeOption):(c=-1,Object.keys(e).some(function(a,b){return e[a]===i.activeOption?(c=b,!0):void 0})),d=m.querySelectorAll(".dropdown-option")[c],i.open&&d&&(b=d.offsetTop-m.scrollTop,0>b?f=d.offsetTop:m.clientHeight<=b+d.clientHeight&&(f=d.offsetTop+d.clientHeight-m.clientHeight),m.scrollTop=f)}function l(){var a,c=m.ownerDocument.defaultView,d=c.getComputedStyle(m,null),f=g.css("display"),h=e.optionsPageSize,i=b("<li class='dropdown-option'>&nbsp;</li>")[0];g.prepend(i),g.css("display","block"),a=i.clientHeight*h,a=["padding","border"].reduce(function(a,b){var c=d.getPropertyValue(b+"-top")||"",e=d.getPropertyValue(b+"-bottom")||"";return a+=+c.replace("px","")||0,a+=+e.replace("px","")||0},a),g.css({"overflow-y":"auto","max-height":a+"px"}),g.css("display",f),b(i).remove()}var m=g[0],n=g.querySelector(".dropdown-option"),o=d.parse(h.options);o&&(i.parseOptions(o.expr),o.expr="$dropdown.options",j(function(a){n.append(a)}),n.attr("ng-repeat",d.toNgRepeat(o)),n.attr("ng-click","$dropdown.addItem( "+o.item+" )"),n.attr("ng-class","{active: $dropdown.activeOption === "+o.item+",disabled: $dropdown.maxItems > 1 &&          $dropdown.isSelected( "+o.item+" )}"),c(n)(f)),l(),i.valueKey=h.value||null,f.$watch("$dropdown.open",k),f.$watch("$dropdown.activeOption",k)},f}]),c.directive("dropdownContainer",["keycodes",function(b){function c(a){var b=String.fromCharCode(a);return b.trim().length||/\s/.test(b)}function d(a,b,c){c.search||(a.ctrlKey?c.items.splice(0):c.items.pop(),b.$safeApply())}function e(a,c,d){var e,f,g,h,i,j,k=d.options,l=d.activeOption,m=1===d.maxItems;if(!d.open)return d.open=!0,void c.$safeApply();switch(i=k.indexOf(l),0>i&&(i=0,l=k[0]),a.preventDefault(),a.keyCode){case b.ARROWUP:f=-1;break;case b.ARROWDOWN:f=1;break;case b.PGUP:f=-4;break;case b.PGDOWN:f=4}g=f,e=0>f?0:k.length-1,h=0>f?"max":"min";do{if(i=Math[h](e,i+f),f=g>1?-1:-1>g?1:g>0?1:-1,l=k[i],m)break;if(e===i&&null!=j&&1===Math.abs(f))break;j=l!==d.activeOption,j&=d.isSelected(l)}while(j);(!d.isSelected(l)||m)&&l!==d.activeOption&&(d.activeOption=l,c.$safeApply())}function f(a,b,c){a.preventDefault(),c.open?c.addItem(c.activeOption):c.open=!0,b.$safeApply()}function g(a,c,d){a.keyCode!==b.TAB&&a.target.blur(),c.$safeApply(d.close)}var h,i;return i={},i[b.BACKSPACE]=d,i[b.TAB]=g,i[b.ESCAPE]=g,i[b.ARROWUP]=e,i[b.ARROWDOWN]=e,i[b.PGUP]=e,i[b.PGDOWN]=e,i[b.ENTER]=f,h={},h.restrict="C",h.require="^dropdown",h.link=function(b,d,e,f){var g=d.querySelector(".dropdown-input"),h=d.querySelector(".dropdown-input-helper"),j=d.querySelector(".dropdown-input input");b.$watch("$dropdown.search",function(a){a&&!f.isFull()&&(f.open=!0)}),d.on("click",function(){j[0].focus()}),j.on("focus",function(){var a=f.isFull();(!a||a&&1===f.maxItems)&&(f.open=!0),b.$safeApply()}),j.on("keydown",function(d){var e,g=d.keyCode,h=i[g];return a.isFunction(h)?h(d,b,f):(e=c(g),e&&!d.ctrlKey&&f.isFull()?d.preventDefault():void 0)}),j.on("keydown",function(){var a;return f.items.length?(h.text(j.val()).css("display","inline"),a=h[0].getBoundingClientRect().width,g.css("width","calc( "+a+"px + 1em )"),void h.css("display","none")):void g.css("width","100%")})},h}]),c.service("repeatParser",function(){var a=this,b=/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/,c=/^(?:([\$\w]+)|\(([\$\w]+)\s*,\s*([\$\w]+)\))$/;a.parse=function(a){var d,e,f,g,h,i=(a||"").match(b);return i&&(d=i[1],e=i[2],f=i[3],i=d.match(c))?(h=i[3]||i[1],g=i[2],{key:g,item:h,expr:e,trackBy:f}):void 0},a.toNgRepeat=function(a){var b=a.key?"("+a.key+", "+a.item+")":a.item,c=a.trackBy?" track by "+a.trackBy:"";return b+" in "+a.expr+c}})}(angular),!function(a){"use strict";var b=a.element,c=a.module("frontkit.utils",[]);c.constant("keycodes",{BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PGUP:33,PGDOWN:34,ARROWLEFT:37,ARROWUP:38,ARROWRIGHT:39,ARROWDOWN:40}),c.config(["$provide",function(b){var c=function(b){return"string"==typeof b||a.isFunction(b)};b.decorator("$rootScope",function(a){return a.$safeApply=function(b,d){var e;for(c(b)&&(d=b,b=a),b=b||a,c(d)&&b.$eval(d),e=b;e;){if(e.$$phase)return;e=e.$parent}b.$apply()},a})}]),b.prototype.querySelector=function(a){return b(this[0].querySelector(a))},b.prototype.querySelectorAll=function(a){return b(this[0].querySelectorAll(a))}}(angular);